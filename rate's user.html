<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Customer Ratings - Foodie Delight</title>
  <link rel="stylesheet" href="css/rate's user.css">
</head>
<body>
  <header class="topbar">
    <h3>Rating Pelanggan</h3>
    <a class="back" href="contact.html">← Kembali</a>
  </header>

  <main class="ratings-wrap">
    <section class="summary">
      <h2>Customer Ratings</h2>
      <div class="avg" id="avgRating">5.0</div>
      <div class="count" id="count">0 rating</div>
    </section>

    <section id="list" class="list"></section>
  </main>

<script>
(function(){
  function readRatings(){
    const raw = localStorage.getItem("ratings");
    return raw ? JSON.parse(raw) : [];
  }

  function renderStars(n){
    let html = "";
    for(let i=1;i<=5;i++){
      html += `<span class="star ${i<=n?'filled':''}">★</span>`;
    }
    return html;
  }

  function render(){
    const arr = readRatings();
    const listEl = document.getElementById("list");

    if(arr.length === 0){
      listEl.innerHTML = `<div class="empty">Belum ada rating.</div>`;
      return;
    }

    // Hitung rata-rata
    const avg = arr.reduce((a,b)=>a + b.rating, 0) / arr.length;
    document.getElementById("avgRating").innerHTML = avg.toFixed(1);
    document.getElementById("count").innerHTML = arr.length + " rating";

    // Tampilkan list
    listEl.innerHTML = arr.map(item => `
      <article class="item">
        <div class="left">
          <strong>${item.name}</strong>
          <div class="stars">${renderStars(item.rating)}</div>
        </div>
        <div class="right">
          <p>${item.message}</p>
        </div>
      </article>
    `).join("");
  }

  render();
})();
</script>

</body>
</html>